<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - IronBro26</title>
<style>
  body {
    background:#0d0d0d;
    color:#fff;
    font-family:Arial,sans-serif;
    margin:0;
    padding:20px;
  }
  h1 { 
    color:#ff1a1a; 
    text-shadow:0 0 10px #ff3333, 0 0 25px #ff6666; 
  }
  a.home-btn {
    display:inline-block;
    padding:10px 20px;
    background:#ff1a1a;
    color:#000;
    font-weight:bold;
    border-radius:8px;
    text-decoration:none;
    box-shadow:0 0 15px #ff4444, 0 0 25px #ff6666;
    margin:15px 0 25px;
    transition:0.3s;
  }
  a.home-btn:hover {
    background:#ff3333;
    box-shadow:0 0 25px #ff6666,0 0 40px #ff9999;
    transform:scale(1.05);
  }
  table {
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
  }
  th, td {
    border:1px solid #ff1a1a;
    padding:10px;
    text-align:left;
  }
  th { background:#ff1a1a; color:#000; }
  td { background:#222; }
</style>
</head>
<body>

<h1>üõ° Admin Panel</h1>

<!-- Home Page Button -->
<a href="IronBro26 Fan Club.html" class="home-btn">üè† Go to Home Page</a>

<h2>Signed Up Users</h2>
<table id="usersTable">
  <tr>
    <th>Email</th>
    <th>Signed Up At</th>
  </tr>
</table>

<h2>Currently Online Users</h2>
<table id="onlineTable">
  <tr>
    <th>Email</th>
    <th>Last Active</th>
  </tr>
</table>

<script>
  // Only allow access to your email
  const currentUser = JSON.parse(localStorage.getItem("currentUser"));
  if(!currentUser || currentUser.email !== "Krfuchs11@icloud.com") {
    alert("Access Denied! Only the owner can access this page.");
    window.location.href = "signup.html"; // redirect others
  }

  // Get users who signed up
  let allUsers = JSON.parse(localStorage.getItem("users") || "[]");
  const usersTable = document.getElementById("usersTable");

  allUsers.forEach(user => {
    let row = usersTable.insertRow();
    row.insertCell(0).innerText = user.email;
    row.insertCell(1).innerText = user.timestamp || "N/A";
  });

  // Track online users
  let onlineUsers = JSON.parse(localStorage.getItem("onlineUsers") || "[]");

  // Update current user as online
  const now = new Date().toLocaleString(); // full date + time
  const exists = onlineUsers.find(u => u.email === currentUser.email);
  if(!exists) {
    onlineUsers.push({email: currentUser.email, lastActive: now});
  } else {
    exists.lastActive = now;
  }
  localStorage.setItem("onlineUsers", JSON.stringify(onlineUsers));

  function renderOnline() {
    const onlineTable = document.getElementById("onlineTable");
    onlineUsers.forEach(user => {
      let row = onlineTable.insertRow();
      row.insertCell(0).innerText = user.email;
      row.insertCell(1).innerText = user.lastActive;
    });
  }

  renderOnline();

  // Remove user from onlineUsers when closing tab
  window.addEventListener("beforeunload", ()=>{
    onlineUsers = onlineUsers.filter(u => u.email !== currentUser.email);
    localStorage.setItem("onlineUsers", JSON.stringify(onlineUsers));
  });
</script>

</body>
</html>
